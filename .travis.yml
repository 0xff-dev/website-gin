language: node_js

node_js:
  - "11"

before_install:
  - git submodule foreach git pull origin master
  - git clone --recurse-submodules --depth 1 https://github.com/google/docsy.git
  - sudo apt-get install hugo

addons:
  apt:
    update: true

script:
  - npm install -D --save autoprefixer
  - npm install -D --save postcss-cli
  - npm audit fix
  - hugo
  - bash <(curl -s https://peek.run/ci)
  - echo 'gin-gonic.com' > public/CNAME

deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GH_TOKEN
  local_dir: public
  on:
    branch: master
